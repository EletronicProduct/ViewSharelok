<!DOCTYPE html>
<html>
<head>
    <title>Secure Tracker Admin Panel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@5.x/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <link rel="stylesheet" href="style.css"/>
</head>
<body>
    <div id="app">
       <v-btn @click="deleteBotData" color="red" class="ml-4 mt-4">
    <v-icon left>mdi-delete-empty</v-icon>
    Hapus Data Bot
       </v-btn>
        <v-app>
            <v-main>
                <div id="map-container"></div>

                <v-btn
                    class="user-toggle-btn"
                    color="primary"
                    fab
                    large
                    @click="showBottomSheet = !showBottomSheet"
                >
                    <v-icon>mdi-account-group</v-icon>
                </v-btn>

                <v-bottom-sheet v-model="showBottomSheet" inset>
                    <v-card>
                        <v-card-title>
                            <v-icon left>mdi-view-dashboard</v-icon>
                            Dashboard Monitoring
                            <v-spacer></v-spacer>
                            <v-btn icon @click="showBottomSheet = false">
                                <v-icon>mdi-close</v-icon>
                            </v-btn>
                        </v-card-title>
                        <v-divider></v-divider>
                        
                        <v-tabs v-model="tab" background-color="transparent" color="primary" grow>
                            <v-tab>
                                <v-icon left>mdi-account-multiple</v-icon>
                                User Aktif
                            </v-tab>
                            <v-tab>
                                <v-icon left>mdi-bell</v-icon>
                                Notifikasi
                                <v-badge v-if="notifications.length > 0" :content="notifications.length" color="red" offset-y="10" offset-x="-5"></v-badge>
                            </v-tab>
                        </v-tabs>

                        <v-tabs-items v-model="tab">
                            <v-tab-item>
                                <v-list dense>
                                    <v-list-item-group color="primary">
                                        <v-list-item v-for="user in users" :key="user.id" @click="panToUser(user)">
                                            <v-list-item-content>
                                                <v-list-item-title>
                                                    {{ user.name }}
                                                    <v-icon :color="user.status === 'active' ? 'green' : 'red'">
                                                        {{ user.status === 'active' ? 'mdi-map-marker-radius' : 'mdi-map-marker-off' }}
                                                    </v-icon>
                                                    <v-icon :color="user.riskLevel === 'high' ? 'red' : user.riskLevel === 'medium' ? 'orange' : 'green'">
                                                        {{ user.riskLevel === 'high' ? 'mdi-alert-octagon' : 'mdi-shield-check' }}
                                                    </v-icon>
                                                </v-list-item-title>
                                                <v-list-item-subtitle>
                                                    Terakhir: {{ user.lastUpdate ? new Date(user.lastUpdate).toLocaleTimeString() : 'N/A' }}
                                                </v-list-item-subtitle>
                                            </v-list-item-content>
                                        </v-list-item>
                                    </v-list-item-group>
                                </v-list>
                            </v-tab-item>
                            
                            <v-tab-item>
                                <v-list dense>
                                    <v-list-item v-if="notifications.length === 0">
                                        <v-list-item-content>
                                            <v-alert type="info" dense outlined class="ma-3">
                                                Tidak ada notifikasi baru.
                                            </v-alert>
                                        </v-list-item-content>
                                    </v-list-item>
                                    <v-list-item v-for="(notif, index) in notifications" :key="index">
                                        <v-list-item-content>
                                            <v-alert :type="notif.type" dense outlined class="ma-1">
                                                {{ notif.message }}
                                                <div class="caption">{{ new Date(notif.time).toLocaleString() }}</div>
                                            </v-alert>
                                        </v-list-item-content>
                                    </v-list-item>
                                </v-list>
                            </v-tab-item>
                        </v-tabs-items>
                    </v-card>
                </v-bottom-sheet>
                
            </v-main>
        </v-app>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    
    
    <script src="main.js">
    </script>
</body>
</html>
